---
jupytext:
  formats: md:myst,ipynb
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.14.0
kernelspec:
  display_name: Python 3.9.12 ('ai')
  language: python
  name: python3
---


```{code-cell}
:tag: hide-cell

import itertools
from itertools import product
from itertools import permutations
```

(ch:combinatorial)=
# Στοιχεία Συνδυαστικής

Σε πολλές περιπτώσεις χρειάζεται να γνωρίζουμε το πλήθος των στοιχειών ενός
συνόλου, δηλαδή την πληθικότητά του, όπως για παράδειγμα στην περίπτωση του
δειγματικού χώρου (δ.χ.) πιθανοτήτων, καθώς από την πληροφορία αυτή υπολογίζεται
η πιθανότητα εμφάνισης κάποιου ενδεχομένου. Όταν τα στοιχεία του συνόλου είναι
πεπερασμένα και αριθμήσιμα αυτό είναι εύκολο, απλά τα καταμετράμε. Υπάρχουν όμως
και περιπτώσεις που η άμεση καταμέτρηση των στοιχείων μπορεί να είναι δύσκολη
έως και αδύνατη. Σε τέτοιες περιπτώσεις καταφεύγουμε σε μεθόδους και εργαλεία
που μας παρέχει ένας άλλος τομέας των μαθηματικών, αυτός της _Συνδυαστικής_
(combinatorics) που ασχολείται με προβλήματα επιλογής, διάταξης και πράξεων μέσα
σε ένα πεπερασμένο ή διακριτό σύστημα. Με απλά λόγια, τα μαθηματικά που
ασχολούνται με τους συνδυασμούς στοιχείων.





## Ορισμοί

Μια από τις βασικές αρχές της Συνδυαστικής είναι αυτή της _απαρίθμησης_:

```{prf:proposition} Βασική Αρχή Απαρίθμησης
:label: enumeration-principle

Έστω ότι μια διαδικασία μπορεί να πραγματοποιηθεί σε $\nu$ διαδοχικές φάσεις $\phi_1, \phi_2, ..., \phi_{\nu}$.
Αν η φάση $\phi_1$ μπορεί να πραγματοποιηθεί με $\kappa_1$ τρόπους και
για καθέναν από αυτούς η φάση $\phi_2$ μπορεί να πραγματοποιηθεί με $\kappa_2$ τρόπους  $\ldots$ και για καθέναν από τους $\kappa_{n-1}$ τρόπους η φάση $\phi_{\nu}$ μπορεί να πραγματοποιηθεί με $\kappa_{\nu}$ τρόπους, τότε η διαδικασία αυτή μπορεί να πραγματοποιηθεί με $\kappa_1 \cdot \kappa_2 \cdot \ldots \cdot \kappa_{\nu}$ τρόπους.
```

Θα εξηγήσουμε τι λέει αυτή η πρόταση με ένα παράδειγμα.


```{topic} Παράδειγμα
Υποθέτουμε ότι κάποιος επιθυμεί να ταξιδέψει από τη Θεσσαλονίκη, μέσω Αθηνών, στο Ηράκλειο Κρήτης χωρίς να χρησιμοποιήσει το αυτοκίνητό του.
Από τη Θεσσαλονίκη μπορεί να ταξιδέψει στην Αθήνα με:

- τρένο (Τ) ή
- λεωφορείο (Λ) ή
- αεροπλάνο (Α) ή
- πλοίο (Π)

και από την Αθήνα στο Ηράκλειο με:

- πλοίο ή
- αεροπλάνο

Θέλουμε να βρούμε τους εναλλακτικούς τρόπους μετακίνησης με τους οποίους μπορεί να πάει κάποιος από τη Θεσσαλονίκη στο Ηράκλειο.

Το ταξίδι λοιπόν γίνεται σε δύο φάσεις.
Η πρώτη φάση είναι η μετάβαση από τη Θεσσαλονίκη στην Αθήνα και η δεύτερη από την Αθήνα στο Ηράκλειο.
Η πρώτη φάση του ταξιδιού μπορεί να γίνει με 4 τρόπους και η δεύτερη με 2 τρόπους.
Η ιδιαιτερότητα είναι ότι ανεξάρτητα από τον τρόπο ταξιδιού της πρώτης φάσης, πάντα υπάρχουν δύο τρόποι ταξιδιού για τη δεύτερη φάση.
Άρα, συνολικά για τους 4 τρόπους ταξιδιού από την αφετηρία, υπάρχουν $4 \cdot 2 = 8$ διαφορετικοί συνδυασμοί μέσων μεταφοράς μέχρι τον προορισμό.
Αν ονομάσουμε $Α = \{Τ, Λ, Α, Π\}$ τους 4 διαφορετικούς τρόπους μετακίνησης της $\Phi_1$ και $Β = \{Α, Π\}$ τους 2 διαφορετικούς τρόπους της $\Phi_2$, τότε οι συνολικοί συνδυασμοί είναι
 
$$Γ = \{(Τ, Α), (Τ, Π), (Λ, Α), (Λ, Π), (Α, Α), (Α, Π), (Π, Α), (Π, Π)\}$$
```

Τα παραπάνω είναι λίγο ή πολύ, διανοητικά αυτονόητα (τουλάχιστο για απλά
καθημερινά προβλήματα).

```{highlights}
Όταν βρεθούμε μπροστά σε προβλήματα με πολλούς υποψήφιους τρόπους δράσης και πιθανώς πολλαπλά αποτελέσματα, ξέρουμε ότι πρέπει να κάνουμε συνδυασμούς. Πρόβλημα δημιουργείται όμως όταν προσπαθούμε να βρούμε
όλους τους πιθανούς συνδυασμούς μίας δραστηριότητας, όπως η παραπάνω, καθώς με
μία μικρή μόνο αύξηση στον αριθμό των φάσεων ή/και των τρόπων, οι δυνατοί
συνδυασμοί αυξάνονται δραματικά. Ας δούμε ένα ακόμη παράδειγμα.
```

```{topic} Παράδειγμα

Ο σερβιτόρος, στο εστιατόριο πολυτελείας που πήγαμε να γευματίσουμε, μας ενημερώνει ότι ένα _πλήρες γεύμα_ αποτελείται από ορεκτικά, κυρίως πιάτο και επιδόρπιο. Το εστιατόρια διαθέτει:

- 2 διαφορετικά ορεκτικά
- 3 διαφορετικά κύρια πιάτα
- 2 διαφορετικά επιδόρπια

Πως αποφασίζουμε τι πλήρες γεύμα να παραγγείλουμε;
Όπως και στο προηγούμενο παράδειγμα και εδώ θα πρέπει να γευματίσουμε σε τρία στάδια.
Κάθε ένα από τα στάδια είναι ανεξάρτητο από το προηγούμενο.
Αυτό σημαίνει ότι οι επιλογές που κάνουμε σε ένα στάδιο δεν επηρεάζουν ούτε επηρεάζονται από τις άλλες επιλογές των άλλων σταδίων.

Σύμφωνα με την αρχή της απαρίθμησης, συνολικά μπορούμε να διαλέξουμε ένα μενού
από ένα πλήθος $2 \cdot 3 \cdot 2 = 12$ διαφορετικών.
Ήδη ο αριθμός των επιλογών είναι αυξημένος, δεν είναι εύκολο να διαλέξουμε από 12 διαφορετικά πιάτα.
Τι θα γινόταν αν, κάθε φάση του γεύματος ήταν αυξημένη κατά μία μόνο επιλογή, δηλαδή αν αντί $(2, 3, 2) (\text{ορεκτικό}, \text{κύριο πιάτο}, \text{επιδόρπιο})$ ήταν $(3, 4, 3)$.
Τότε οι δυνατοί συνδυασμοί του μενού θα ήταν $36$ κάτι που θα έκανε
την επιλογή πρακτικά αδύνατη (θα επιλέγαμε στην τύχη ή κατόπιν προτροπής).
```

Η παραπάνω αρχή καθώς και οι έννοιες των διατάξεων και των συνδυασμών, που
ακολουθούν, δε μας βοηθούν στο να πάρουμε κάποια απόφαση αλλά στο να
υπολογίσουμε το πόσες είναι οι δυνατές επιλογές που έχουμε.
Με βάση αυτές και εφαρμογή στη συνέχεια άλλων μαθηματικών πρακτικών, όπως των
πιθανοτήτων και της στατιστικής, μπορούμε να βρούμε τρόπους δράσης.




## Παραγοντικό

Στα μαθηματικά τo *παραγοντικό* ενός μη-αρνητικού, ακέραιου $\nu$ ($\nu \in \mathbb{R^{+}}$) συμβολίζεται με $\nu!$, διαβάζεται σαν "νι παραγοντικό" και είναι το γινόμενο όλων των θετικών ακέραιων, που είναι μικρότεροι ή ίσοι με $\nu$, δηλαδή $\nu! = 1 \cdot 2 \cdot 3 \ldots \nu$.
Για παράδειγμα:

```{math}

\begin{split}
8!  &= 1\cdot2\cdot3\cdot4\cdot5\cdot6\cdot7\cdot8 = 40.320 \\ 
10! &= 1\cdot2\cdot3\cdot4\cdot5\cdot6\cdot7\cdot8\cdot9\cdot10 = 3.628.800.320 \\
12! &= 1\cdot2\cdot3\cdot4\cdot5\cdot6\cdot7\cdot8\cdot9\cdot10\cdot11\cdot12 = 479.001.600
\end{split}
```

Η έννοια του παραγοντικού έχει ανακαλυφθεί σε αρχαίες ήδη κουλτούρες και είναι συνδεδεμένη, μέχρι και σήμερα, με τη διαχείριση πολύ μεγάλων αριθμών.

Ισχύει *κατά σύμβαση* ότι $0! = 1$ και *εξ ορισμού* ότι $1! = 1$.




## Διατάξεις

Ας υποθέσουμε ένα σύνολο $A = \{a_1, a_2, \ldots, a_{n} \mid n \in \mathbb{R^{+}}\}$.
Θέλουμε να βρούμε με πόσους διαφορετικούς τρόπους, μπορούμε να επιλέξουμε $\kappa$ στοιχεία του $Α$ (με $\kappa \leq \nu$).
Για παράδειγμα, αν το $A$ έχει 10 στοιχεία, πόσες διαφορετικές τριάδες από αυτά υπάρχουν ή πόσες τετράδες ή δυάδες κ.λπ.

Οι διαφορετικοί αυτοί τρόποι παρουσίασης των στοιχείων ενός συνόλου λέγονται
*διατάξεις* [^k-tuple] (permutations) και το χαρακτηριστικό τους είναι ότι **η σειρά των στοιχείων έχει σημασία**.
Το σύνολο όλων αυτών των διατάξεων συμβολίζεται $P_{\nu}^{\kappa}$ (στα ελληνικά
συνήθως $\Delta_{\nu}^{\kappa}$).

[^k-tuple]: Η κάθε μία από αυτές τις διατάξεις λέγεται επίσης και "κ-πλειάδα" (k-tuple) όπου η λέξη "πλειάδα" σημαίνει ακριβώς ένα σύνολο αντικειμένων (στη συγκεκριμένη περίπτωση $\kappa$ αντικειμένων του $Α$).

Για να υπολογίσουμε το μέγιστο αριθμό των δυνατών διατάξεων, των μελών ενός συνόλου, θα πρέπει να λάβουμε υπόψη μας αν και κατά πόσο, τα στοιχεία του συνόλου μπορούν να επαναλαμβάνονται,
Μπορούμε λοιπόν να διακρίνουμε τις παρακάτω περιπτώσεις για τον υπολογισμό διατάξεων.

```{admonition} Σημείωση
:class: info

Είναι πιθανό οι εκφράσεις: "η σειρά δεν έχει σημασία" και "η σειρά έχει σημασία", να μας οδηγήσουν σε λανθασμένα συμπεράσματα.
Ας εξηγήσουμε εδώ τι σημαίνουν.

Όταν κάνουμε συνδυασμούς και φτάσουμε στο σημείο, για παράδειγμα, να επιλέξουμε αν τα στοιχεία $(\alpha, b)$ και $(b, \alpha)$ είναι αποδεκτοί συνδυασμοί (ή διατάξεις) τότε, η έκφραση "η σειρά έχει σημασία" σημαίνει ότι ναι! και τα δύο είναι αποδεκτά γιατί η σειρά που τοποθετούνται *έχει σημασία*.
Αν όμως "η σειρά δεν έχει σημασία" τότε, από τη στιγμή που θα επιλέξουμε το ένα ζεύγος (όποιο και αν είναι αυτό) το άλλο δεν είναι αποδεκτό, γιατί δεν έχει με ποια σειρά τα επιλέξαμε, *αλλά ήδη το κάναμε*!

Φυσικά η εννοιολογική αυτή εξήγηση επεκτείνεται και για οποιοδήποτε αριθμό στοιχείων.
```


### Διατάξεις χωρίς επανάληψη

Είναι η περίπτωση που τα στοιχεία του $Α$ χρησιμοποιούνται μία φορά[^permutations1] μόνο για τον υπολογισμό της όποιας κ-πλειάδας διατάξεων.
Με απλά λόγια, με πόσους **διαφορετικούς τρόπους** μπορούμε να διατάξουμε τα
$\nu$ στοιχεία του $A$ ανά $\kappa$.
Σε αυτή την περίπτωση οι διατάξεις υπολογίζονται από τις σχέσεις:

```{math}
:label: permutations-norepet-1

P_{\nu}^{\kappa} = \nu\cdot(\nu - 1)\cdot(\nu - 2)\ldots(\nu - \kappa + 1)
```

και 

```{math}
:label: permutations-norepet-2

P_{\nu}^{\kappa} = \frac{\nu\,!}{(\nu-\kappa)!}
```

που είναι ισοδύναμες.

[^permutations1]: Μία φορά μόνο στην ίδια κ-πλειάδα, όχι σε διαφορετικές! Για
παράδειγμα, αν μιλάμε για τριάδες των $(Α,Β,Γ,Δ)$, τα $(Α,Β,Γ)$, $(Α,Γ,Β)$,
$(Β,Γ,Α)$ κ.λπ. **είναι** διαφορετικοί τρόποι διατάξεων γιατί στις διατάξεις η
σειρά μετράει. Οι $(Α,Α,Γ)$, $(Α,Β,Β)$, $(Β,Γ,Γ)$ κ.λπ. **δεν είναι**
διαφορετικοί τρόποι διατάξεων γιατί κανένα στοιχείο δεν πρέπει να
επαναλαμβάνεται στην τριάδα.

```{code-cell}
:tags: [hide-cell, output_scroll, margin]

five_athletes = ['Α','Β','Γ','Δ','Ε']
three_winners = permutations(five_athletes,3)
three_winners_list = list(three_winners)

print(len(three_winners_list))
for i in three_winners_list:
    print(i)
```

> **Άσκηση**: Σε ένα αγώνα δρόμου τρέχουν 5 αθλητές, οι $\{Α, Β, Γ, Δ, Ε\}$.
> Πόσες είναι οι δυνατές διατάξεις 3 νικητών (1ος, 2ος 3ος);
>
> **Απάντηση** Αφού 5 είναι οι αθλητές, άρα 5 είναι οι υποψήφιοι για την 1η θέση
> δηλαδή η 1η θέση μπορεί να συμπληρωθεί με 5 τρόπους.
> Η δεύτερη θέση όμως μπορεί να συμπληρωθεί με 4 τρόπους, αφού από τους 5
> αθλητές ο ένας είναι ήδη 1ος (δεν μπορεί να είναι και 2ος). Με ανάλογο τρόπο,
> η 3η θέση μπορεί να συμπληρωθεί με μόνο 3 τρόπους. Σύμφωνα με την
> {prf:ref}`"αρχή της απαρίθμησης" <enumeration-principle>` η τριάδα των νικητών
> μπορεί να συμπληρωθεί με $5\cdot4\cdot3 = 60$ διαφορετικούς τρόπους, (πρακτικά
> είναι η εφαρμογή της {eq}`σχέσης <permutations-norepet-1>`).
>
> Εναλλακτικά, με εφαρμογή της {eq}`permutations-norepet-2`:
>   
> ````{math}
>
> \frac{\nu\,!}{(\nu - \kappa)!} = \frac{5!}{(5-3)!} = \frac{5!}{2!} = \frac{2!\cdot3\cdot4\cdot5}{2!} = 3\cdot4\cdot5 = 60
> ````






### Διατάξεις με επανάληψη

Πρόκειται για την περίπτωση όπου κάθε στοιχείο του $Α$, από τα συνολικά $\nu$, μπορεί να επαναλαμβάνεται σε οποιαδήποτε κ-πλειάδα, μέχρι και $\kappa$ φορές.

Σε αυτή την περίπτωση ο συνολικός αριθμός των διατάξεων δίνεται από τη σχέση 

```{math}
:label: math-permutations-with-repet-1

P_{\nu}^{\kappa} = \nu^{\kappa}
```

Επειδή ίσως η παραπάνω ερμηνεία μπορεί να δημιουργεί ερωτηματικά, θα δώσουμε ένα παράδειγμα.

```{code-cell} ipython3
:tags: [margin, hide-cell]

digits = [3,4,7]
two_digit = product(digits, repeat = 2)
two_digit_list = list(two_digit)

print(len(two_digit_list))
for i in two_digit_list:
    print(i)
```

> **Παράδειγμα:** Πόσοι διψήφιοι αριθμοί μπορούν να σχηματιστούν χρησιμοποιώντας τα 3 ψηφία του $Α = \{3, 4, 7\}$;
> 
> **Απάντηση:** Συνολικά πρόκειται για $\nu = 3$ ψηφία που θέλουμε να τα διατάξουμε σε διψήφια νούμερα ($\kappa = 2$).
> Η διαφορά με την παραπάνω περίπτωση διατάξεων είναι ότι κάθε νούμερο από τα αρχικά 3, μπορεί να επαναληφθεί μέχρι και 2 φορές για το σχηματισμό των διψήφιων.
> Πιο απλά, οι περιπτώσεις 33, 44, 77, είναι αποδεκτές.
> Αν θέλαμε να κάνουμε διαφορετικές τριάδες ($\kappa = 3$), αποδεκτές θα ήταν **και** οι επιλογές 333, 444, 777.
>
> Επανερχόμενοι στο αρχικό ερώτημα, η απάντηση είναι: {math}`P_{\nu}^{\kappa} = \nu^{\kappa} = 3^2 = 9`


Πρακτικά η συγκεκριμένη περίπτωση διατάξεων είναι όλα τα διατεταγμένα ζεύγη που προκύπτουν από το καρτεσιανό γινόμενο του $Α$ με τον εαυτό του:

```{math}
A \times A &= \{3,4,7\} \times \{3,4,7\} \\
           &= \{(3,3), (3,4), (3,7), (4,3), (4,4), (4,7), (7,3), (7,4), (7,7)\}
```





### Μεταθέσεις

Στην ειδική περίπτωση που $\nu = \kappa$ δηλαδή όταν θέλουμε να (ανα)διατάξουμε όλα τα στοιχεία του $Α$, μιλάμε για μεταθέσεις και όχι για διατάξεις.
Όταν δηλαδή θέλουμε να βρούμε με πόσους τρόπους μπορούμε να βάλουμε όλα τα $\nu$ στοιχεία σε μία σειρά.

Ο συνολικός αριθμός μεταθέσεων υπολογίζεται από τη σχέση: 

```{math}
:label: math-permutations-1

P_{\nu} = \nu\,!
```

Αυτός είναι και ο ορισμός του παραγοντικού!

```{code-cell} ipython3
:tags: [margin, hide-cell]

persons = "ΑΒΓΔ"
all_perms = permutations(persons)
all_perms_list = list(all_perms)

print(len(all_perms_list))
for j in all_perms_list:
  print(j)
```

> **Παράδειγμα:** Αν οι $\{Α, Β, Γ, Δ\}$ είναι 4 άτομα, με πόσους διαφορετικούς τρόπους μπορούμε να τους βάλουμε όλους σε μία σειρά (όλους σημαίνει $\nu = \kappa = 4$);
> 
> **Απάντηση:** Με $4! = 1\cdot2\cdot3\cdot4 = 24$





## Συνδυασμοί